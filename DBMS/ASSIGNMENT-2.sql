CREATE DATABASE CRICKET_TOURNAMENT; 
USE CRICKET_TOURNAMENT;

CREATE TABLE SUPPLIER(
	SID VARCHAR(5) PRIMARY KEY,
	SNAME VARCHAR(20),
	CITY VARCHAR(10)
);
SELECT * FROM SUPPLIER;

CREATE TABLE ITEM(
	ITEM_ID VARCHAR(10) PRIMARY KEY,
    INAME VARCHAR(10),
    COLOR VARCHAR(10),
    WEIGHT int
);
SELECT * FROM ITEM;

/* TYPE 1
CREATE TABLE SUPPLY (
    SID VARCHAR(5),
    ITEM_ID VARCHAR(10),
    QUANTITY INT,
    PRIMARY KEY (SID, ITEM_ID),
    FOREIGN KEY (SID) REFERENCES SUPPLIER(SID),
    FOREIGN KEY (ITEM_ID) REFERENCES ITEM(ITEM_ID)
);
*/
CREATE TABLE SUPPLY (
    SID VARCHAR(5),
    ITEM_ID VARCHAR(10),
    QUANTITY INT,
    FOREIGN KEY (SID) REFERENCES SUPPLIER(SID),
    FOREIGN KEY (ITEM_ID) REFERENCES ITEM(ITEM_ID)
);


SELECT * FROM SUPPLY;

/* 
	INSERT ITEMS FOR SUPPLIER
*/
INSERT INTO SUPPLIER VALUES
('S001','Manish','Kolkata'),
('S002','Hari','Delhi'),
('S003','Kundan','Kolkata'),
('S004','Sagar','Patna'),
('S005','Zahir','Delhi');

SELECT * FROM SUPPLIER;

/* 
	INSERT ITEMS FOR ITEM
*/
INSERT INTO ITEM VALUES
('ITEM 1','Desk','Brown', 20),
('ITEM 2','Chair','Red', 7),
('ITEM 3','Board-1','Blue',15),
('ITEM 4','Board-2','White',10),
('ITEM 5','Marker','Black',20);
SELECT * FROM ITEM;

/* 
	INSERT ITEMS FOR SUPPLY
*/
INSERT INTO SUPPLY VALUES
('S002','ITEM 2',210),
('S001','ITEM 5',200),
('S005','ITEM 1',125),
('S002','ITEM 5',500),
('S005','ITEM 2',156),
('S001','ITEM 1',370);
SELECT * FROM SUPPLY;

/*
Q1: FIND ALL THE EXISTING SUPPLIER
*/
SELECT * FROM SUPPLIER;

/*
Q2: FIND ALL THE ITEMS WHICH ARE SOLD BY AT LEAST ONE SUPPLIER
*/
SELECT * FROM ITEM
WHERE ITEM_ID IN(
	SELECT ITEM_ID FROM SUPPLY
	GROUP BY SID
	HAVING COUNT(ITEM_ID)>=1);

/*
Q3: FIND ALL THE SUPPLIERS WHO LIVES IN DELHI
*/
SELECT * FROM SUPPLIER
WHERE CITY = 'DELHI';

/*
Q4. FIND ALL THE SUPPLIERS WHO DO NOT LIVES IN KOLKATA
*/
SELECT * FROM SUPPLIER
WHERE CITY != 'Kolkata';

/*
Q5. FIND ALL THE SUPPLIERS WHO DO NOT SELL ANY ITEM
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID NOT IN (
    SELECT DISTINCT SID
    FROM SUPPLY
);

/*
Q6. FIND ALL THE SUPPLIERS WHO SELL AT LEAST ONE ITEM
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID IN (
    SELECT DISTINCT SID
    FROM SUPPLY
);

/*
Q7. FIND ALL THE SUPPLIERS WHO SELL THE ITEM NUMBER 'ITEM 1'
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID IN (
    SELECT SID
    FROM SUPPLY
    WHERE ITEM_ID = 'ITEM 1'
);

/*
Q8.  FIND ALL THE SUPPLIERS WHO SELL EITHER ITEM NUMBER 'ITEM 1' OR 'ITEM 2'
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID IN (
    SELECT SID
    FROM SUPPLY
    WHERE ITEM_ID IN ('ITEM 1','ITEM 2')
);

/*
Q9. fIND ALL THE SUPPLIERS WHO SELL THE ITEM OF COLOR RED
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID IN (
	SELECT SID
    FROM SUPPLY 
    WHERE ITEM_ID IN(
			SELECT ITEM_ID
            FROM ITEM
            WHERE COLOR = 'Red')
            );

/*
Q10. FIND ALL THE SUPLIERS WHO SELL THE ITEM OF COLOR RED WITH QUANTITY BETWEEN 200 AND 500
*/
SELECT SID, SNAME
FROM SUPPLIER
WHERE SID IN (
	SELECT SID
    FROM SUPPLY 
    WHERE QUANTITY BETWEEN 200, 500 AND ITEM_ID IN(
			SELECT ITEM_ID
            FROM ITEM
            WHERE COLOR = 'Red')
            );
